---
- name: RPi netboot special | Hold kernels
  dpkg_selections:
    name: '{{ item }}'
    selection: hold
  loop:
    - linux-headers-raspi
    - linux-image-raspi
    - linux-raspi

- name: RPi netboot special | NFS dependencies
  apt:
    pkg:
      - nfs-common
    state: latest

- name: RPi netboot special | Mask unwanted services
  systemd:
    name: '{{ item }}'
    masked: yes
  loop:
    - lvm2-lvmpolld.socket
    - lvm2-monitor.service
    - multipathd.service
    - unattended-upgrades.service
    - firewalld.service
    - ufw.service
    - fwupd.service
    - fwupd-refresh.timer
