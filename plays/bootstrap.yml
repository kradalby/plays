---
- name: Setup base configuration
  hosts: all

  pre_tasks:
    - name: Upgrade packages
      apt:
        upgrade: true
        update_cache: true

    - name: Install packages
      apt:
        update_cache: true
        pkg:
          - mosh
          - tmux
          - socat
          - tcpdump
        state: latest

  roles:
    - repo
    - dotfiles
    - apticron
    - { role: postfix, when: skip_postfix is not defined }
    - snmpd
    - {
        role: prometheus-node-exporter,
        when: skip_node_exporter is not defined,
      }
